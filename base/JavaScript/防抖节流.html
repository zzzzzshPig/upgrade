<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>防抖节流</title>
</head>
<body>
    <input type="text" id="fd"/>
    
    <input type="text" id="jl"/>
    
    <script>
        // 防抖 在指定时间内连续触发会重置触发
        function fangdou (ms) {
            let time = null

            // 无等待任务 则设置等待任务
            // 否则清空等待任务 重置值
            return function () {
				return new Promise((resolve, reject) => {
				    if (time === null) {
                        time = setTimeout(resolve, ms)
                    } else {
				        clearTimeout(time)
                        time = null
                        reject()
                    }
				})
			}
        }
        
        const fangdouInstance = fangdou(1000)
        fd.oninput = function () {
			fangdouInstance().then(() => {
				console.log(1)
            }).catch(a => {
            	console.log(a)
            })
        }
        
        // 节流 在指定时间段只能触发一次
        function jieliu (ms) {
			let ctime = 0

			return function () {
				return new Promise((resolve, reject) => {
					const now = Date.now()

                    if (now - ctime >= ms) {
						resolve()
						ctime = now
					} else {
						reject()
                    }
				})
			}
        }

		const jieliuInstance = jieliu(1000)
		jl.oninput = function () {
			jieliuInstance().then(() => {
				console.log(1)
			}).catch(a => {
				console.log(a)
			})
		}
    </script>
</body>
</html>
